<html>
	<head>
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
	</head>
	<link href="https://fonts.googleapis.com/css?family=Play&display=swap" rel="stylesheet">
	<style type="text/css">
		pre {
			white-space: pre;
		}

		textarea {
	    border: none;
	    font-size: 1.25em;
	    height: 50vh;
	    line-height: 1.35em;
	    width: 100%;
	    font-family: monospace;
	    background-color: #eee;
	    padding: 1em;
		}

		p {
			font-weight: bold;
		}
		#runner {
			background: linear-gradient(rgba(27,188,194,1) 0%, rgba(24,163,168,1) 100%);
			padding: 4px 12px;
			font-size: 18px;
			color: white;
			padding: 8px 20px;
			display: inline-block;
			position: relative;
			border: 1px solid rgba(0,0,0,0.21);
			border-bottom: 4px solid rgba(0,0,0,0.21);
			border-radius: 4px;
			margin: 15px;
			text-shadow: 0 1px 0 rgba(0,0,0,0.15);
		}
		html {
			/*font-family: 'Abril Fatface', cursive;*/
			font-family: 'Play', sans-serif;
		}
	</style>
	<!-- Include the JS generated by `wasm-pack build` -->
	<script src='pkg/linp_wasm.js'></script>
	<body>
		<h2> > Maximize Sales</h2>
		
		<p>
			We can solve many optimization problems using the 
			<a href="https://en.wikipedia.org/wiki/Simplex_algorithm">Dantzig's simplex algorithm</a>. All we have to 
			do is take our real world problem and write it in a 
			format that our optimizer can solve.
		</p>
		<p>
			Below we outline a problem where we can maximize the 
			profits constrained by our materials.
		</p>
		<p>
			Try own LP problems! This website is built using 
			WASM - which means it works offline!
		</p>
		
		<h2> > Problem Editor</h2>
		<textarea class="form-control" id="my-lp-problem">
# bakery.lp;

# Vars;
# bagels = number of bagels produced;
# doughnuts = number of doughuts produced;
var bagels;
var doughnuts;

# Objective;
maximize profits: 3*bagels + 1.25*doughnuts;

# Constraints;
subject to flour: 12*bagels + 6.5*doughnuts <= 400;
subject to milk: 1*bagels + .5*doughnuts <= 200;
subject to sugar: 2*doughnuts + 0.25*bagels <= 200;
subject to bagel_min: bagels >= 12;
subject to doughnut_min: doughnuts >= 14;
		  </textarea>
		<button id="runner">Run</button>
		<h1 id="info">_<h1>
	</body>
	<script type=module>
	// Like with the `--target web` output the exports are immediately
	// available but they won't work until we initialize the module. Unlike
	// `--target web`, however, the globals are all stored on a
	// `wasm_bindgen` global. The global itself is the initialization
	// function and then the properties of the global are all the exported
	// functions.
	//
	// Note that the name `wasm_bindgen` can be configured with the
	// `--no-modules-global` CLI flag
	const { execute } = wasm_bindgen;
	async function run() {
	  // try the optimized version
	  await wasm_bindgen('./pkg/linp_wasm_opt.wasm');
	  // await wasm_bindgen('./pkg/linp_wasm_bg.wasm');


	  // example from
	  // https://storm.cis.fordham.edu/~zhang/cs5835/slides/LinearProgramming_handout.pdf
	  var text_prob = document.getElementById("my-lp-problem").value 
	  console.log(text_prob)
	  const result = execute(text_prob);
	  const ret_obj = JSON.parse(result)
	  console.log(ret_obj)
	  document.getElementById("info").innerHTML = result
	}
	function clickedToRun() {
		run();
	}
	document.getElementById("runner").onclick=clickedToRun;
	</script>
</html>